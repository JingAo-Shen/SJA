<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Javaå…¨æ ˆå¼€å‘çŸ¥è¯†å›¾è°±</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            overflow: hidden;
        }
        
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.8);
            padding: 15px;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 10px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .control-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .control-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .control-btn:hover::before {
            left: 100%;
        }
        
        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .control-btn.active {
            background: linear-gradient(135deg, #feca57, #ff9ff3);
            box-shadow: 0 4px 15px rgba(254, 202, 87, 0.3);
        }
        
        .control-btn.active:hover {
            box-shadow: 0 6px 25px rgba(254, 202, 87, 0.5);
        }
        
        #knowledge-graph {
            width: 100vw;
            height: 100vh;
            margin-top: 80px;
        }
        
        .tooltip {
            position: absolute;
            background: linear-gradient(135deg, rgba(0,0,0,0.95), rgba(30,30,30,0.95));
            color: white;
            padding: 15px 18px;
            border-radius: 12px;
            font-size: 13px;
            pointer-events: none;
            z-index: 1001;
            max-width: 320px;
            line-height: 1.5;
            display: none;
            border: 1px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.4);
        }
        
        .tooltip::before {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 20px;
            width: 12px;
            height: 12px;
            background: rgba(0,0,0,0.95);
            transform: rotate(45deg);
            border-right: 1px solid rgba(255,255,255,0.2);
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .legend {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0,0,0,0.85);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            max-width: 240px;
            transition: all 0.3s ease;
        }
        
        .legend:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.4);
        }
        
        .legend h4 {
            margin-bottom: 15px;
            color: #feca57;
            font-size: 14px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 8px;
            cursor: pointer;
            user-select: none;
        }
        
        .legend h4:hover {
            color: #ff9ff3;
        }
        
        .legend-content {
            transition: all 0.3s ease;
        }
        
        .legend.collapsed .legend-content {
            max-height: 0;
            overflow: hidden;
            opacity: 0;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 13px;
            padding: 5px 8px;
            border-radius: 8px;
            transition: all 0.2s ease;
        }
        
        .legend-item:hover {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 12px;
            border: 2px solid rgba(255,255,255,0.3);
            transition: all 0.2s ease;
        }
        
        .legend-item:hover .legend-color {
            transform: scale(1.2);
            border-color: rgba(255,255,255,0.6);
        }
        
        .info-panel {
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            max-width: 250px;
            display: none;
        }
        
        .status-bar {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.85);
            padding: 12px 20px;
            border-radius: 25px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.1);
            font-size: 12px;
            color: rgba(255,255,255,0.8);
            display: flex;
            align-items: center;
            gap: 15px;
            min-width: 200px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .status-item .icon {
            font-size: 14px;
        }
        
        .help-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.95);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            display: none;
            z-index: 3000;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .help-panel h3 {
            color: #feca57;
            margin-bottom: 20px;
            text-align: center;
            font-size: 18px;
        }
        
        .help-section {
            margin-bottom: 20px;
        }
        
        .help-section h4 {
            color: #ff9ff3;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .help-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .help-key {
            background: rgba(255,255,255,0.1);
            padding: 4px 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ§  Javaå…¨æ ˆå¼€å‘çŸ¥è¯†å›¾è°±</h1>
        <div class="controls">
            <input type="text" id="searchInput" placeholder="ğŸ” æœç´¢çŸ¥è¯†ç‚¹..." style="
                width: 100%;
                padding: 12px 15px;
                margin-bottom: 15px;
                border: 1px solid rgba(255,255,255,0.3);
                border-radius: 25px;
                background: rgba(255,255,255,0.1);
                color: white;
                font-size: 13px;
                outline: none;
                transition: all 0.3s ease;
            " onkeyup="searchNodes(this.value)">
            <button class="control-btn active" onclick="showAllNodes()">ğŸŒ æ˜¾ç¤ºå…¨éƒ¨</button>
            <button class="control-btn" onclick="filterByCategory('æ ¸å¿ƒè¯­è¨€')">â˜• Javaæ ¸å¿ƒ</button>
            <button class="control-btn" onclick="filterByCategory('Webå¼€å‘')">ğŸŒ Webå¼€å‘</button>
            <button class="control-btn" onclick="filterByCategory('æ•°æ®å¤„ç†')">ğŸ—„ï¸ æ•°æ®å¤„ç†</button>
            <button class="control-btn" onclick="filterByCategory('æ¡†æ¶æŠ€æœ¯')">ğŸ—ï¸ æ¡†æ¶æŠ€æœ¯</button>
            <button class="control-btn" onclick="filterByCategory('å¾®æœåŠ¡')">ğŸ”§ å¾®æœåŠ¡</button>
            <button class="control-btn" onclick="filterByCategory('å·¥å…·éƒ¨ç½²')">ğŸ› ï¸ å·¥å…·éƒ¨ç½²</button>
            <div style="border-top: 1px solid rgba(255,255,255,0.2); margin: 15px 0; padding-top: 15px;">
                <button class="control-btn" onclick="resetGraph()">ğŸ”„ é‡ç½®è§†å›¾</button>
                <button class="control-btn" onclick="toggleSimpleMode()" id="simple-mode-btn">âš¡ ç®€åŒ–æ¨¡å¼</button>
                <button class="control-btn" onclick="toggleHelp()">â“ å¿«æ·é”®å¸®åŠ©</button>
                <a href="../index.html" class="control-btn" style="text-decoration: none;">ğŸ  è¿”å›é¦–é¡µ</a>
            </div>
        </div>
    </div>
    
    <div id="knowledge-graph"></div>
    
    <div class="tooltip" id="tooltip"></div>
    
            <div class="legend" id="legend">
            <h4 onclick="toggleLegend()">ğŸ“Š èŠ‚ç‚¹ç±»å‹ <span id="legend-toggle">â–¼</span></h4>
            <div class="legend-content" id="legend-content">
                <div class="legend-item">
                    <div class="legend-color" style="background: #ff6b6b;"></div>
                    <span>æ ¸å¿ƒè¯­è¨€</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #4ecdc4;"></div>
                    <span>Webå¼€å‘</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #45b7d1;"></div>
                    <span>æ•°æ®å¤„ç†</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #96ceb4;"></div>
                    <span>æ¡†æ¶æŠ€æœ¯</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #feca57;"></div>
                    <span>å¾®æœåŠ¡</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #ff9ff3;"></div>
                    <span>å·¥å…·éƒ¨ç½²</span>
                </div>
                
                <h4 style="margin: 15px 0 10px 0; cursor: default;">ğŸ® å¿«é€Ÿæ“ä½œ</h4>
                <div style="font-size: 11px; line-height: 1.8; color: rgba(255,255,255,0.8);">
                    <div>ğŸ–±ï¸ æ»šè½®ç¼©æ”¾ / æ‹–æ‹½å¹³ç§»</div>
                    <div>ğŸ‘† å•å‡»æŸ¥çœ‹ / åŒå‡»å­¦ä¹ </div>
                    <div>ğŸ¯ æ‚¬åœè¯¦æƒ… / å³é”®èœå•</div>
                    <div>âŒ¨ï¸ F1å¸®åŠ© / Ctrl+Fæœç´¢</div>
                </div>
            </div>
        </div>
    
    <div class="info-panel" id="info-panel">
        <h4 id="node-title"></h4>
        <p id="node-description"></p>
        <div id="node-relations"></div>
    </div>
    
    <div class="status-bar" id="status-bar">
        <div class="status-item">
            <span class="icon">ğŸ“Š</span>
            <span id="node-count">èŠ‚ç‚¹: 0</span>
        </div>
        <div class="status-item">
            <span class="icon">ğŸ”—</span>
            <span id="link-count">è¿æ¥: 0</span>
        </div>
        <div class="status-item">
            <span class="icon">ğŸ”</span>
            <span id="zoom-level">ç¼©æ”¾: 100%</span>
        </div>
    </div>
    
    <div class="help-panel" id="help-panel">
        <h3>ğŸ® æ“ä½œæŒ‡å—</h3>
        
        <div class="help-section">
            <h4>ğŸ–±ï¸ é¼ æ ‡æ“ä½œ</h4>
            <div class="help-item">
                <span>å•å‡»èŠ‚ç‚¹</span>
                <span>æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</span>
            </div>
            <div class="help-item">
                <span>åŒå‡»èŠ‚ç‚¹</span>
                <span>æ‰“å¼€å­¦ä¹ é¡µé¢</span>
            </div>
            <div class="help-item">
                <span>å³é”®èŠ‚ç‚¹</span>
                <span>æ˜¾ç¤ºä¸Šä¸‹æ–‡èœå•</span>
            </div>
            <div class="help-item">
                <span>æ»šè½®</span>
                <span>ç¼©æ”¾è§†å›¾</span>
            </div>
            <div class="help-item">
                <span>æ‹–æ‹½ç©ºç™½å¤„</span>
                <span>å¹³ç§»è§†å›¾</span>
            </div>
            <div class="help-item">
                <span>æ‚¬åœèŠ‚ç‚¹</span>
                <span>æ˜¾ç¤ºæç¤ºä¿¡æ¯</span>
            </div>
        </div>
        
        <div class="help-section">
            <h4>âŒ¨ï¸ é”®ç›˜å¿«æ·é”®</h4>
            <div class="help-item">
                <span>æœç´¢åŠŸèƒ½</span>
                <span class="help-key">Ctrl + F</span>
            </div>
            <div class="help-item">
                <span>æ¸…ç©ºæœç´¢</span>
                <span class="help-key">ESC</span>
            </div>
            <div class="help-item">
                <span>å‘ä¸Šç§»åŠ¨</span>
                <span class="help-key">â†‘</span>
            </div>
            <div class="help-item">
                <span>å‘ä¸‹ç§»åŠ¨</span>
                <span class="help-key">â†“</span>
            </div>
            <div class="help-item">
                <span>å‘å·¦ç§»åŠ¨</span>
                <span class="help-key">â†</span>
            </div>
            <div class="help-item">
                <span>å‘å³ç§»åŠ¨</span>
                <span class="help-key">â†’</span>
            </div>
            <div class="help-item">
                <span>æ˜¾ç¤ºå¸®åŠ©</span>
                <span class="help-key">F1</span>
            </div>
        </div>
        
        <div class="help-section">
            <h4>ğŸ¯ ä½¿ç”¨æŠ€å·§</h4>
            <div class="help-item">
                <span>æŒ‰ç±»åˆ«ç­›é€‰</span>
                <span>ç‚¹å‡»æ§åˆ¶é¢æ¿æŒ‰é’®</span>
            </div>
            <div class="help-item">
                <span>å¿«é€Ÿæœç´¢</span>
                <span>è¾“å…¥å…³é”®è¯</span>
            </div>
            <div class="help-item">
                <span>æŸ¥çœ‹è¿æ¥</span>
                <span>å³é”® â†’ æŸ¥æ‰¾ç›¸å…³</span>
            </div>
            <div class="help-item">
                <span>é‡ç½®è§†å›¾</span>
                <span>ç‚¹å‡»é‡ç½®æŒ‰é’®</span>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 20px;">
            <button class="control-btn" onclick="toggleHelp()">å…³é—­å¸®åŠ©</button>
        </div>
    </div>
    
    <script>
        // çŸ¥è¯†å›¾è°±æ•°æ® - çœŸå®çš„è¯­ä¹‰å…³ç³»ç½‘ç»œ
        const knowledgeData = {
            nodes: [
                // æ ¸å¿ƒè¯­è¨€å±‚
                {id: "Java", name: "Javaè¯­è¨€", category: "æ ¸å¿ƒè¯­è¨€", level: 1, 
                 description: "é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¹³å°æ— å…³æ€§ï¼Œå¼ºç±»å‹", 
                 link: "Javaè¯­è¨€.html"},
                {id: "OOP", name: "é¢å‘å¯¹è±¡", category: "æ ¸å¿ƒè¯­è¨€", level: 2,
                 description: "å°è£…ã€ç»§æ‰¿ã€å¤šæ€ä¸‰å¤§ç‰¹æ€§", 
                 link: "é¢å‘å¯¹è±¡.html"},
                {id: "JVM", name: "Javaè™šæ‹Ÿæœº", category: "æ ¸å¿ƒè¯­è¨€", level: 2,
                 description: "å­—èŠ‚ç æ‰§è¡Œç¯å¢ƒï¼Œåƒåœ¾å›æ”¶ï¼Œå†…å­˜ç®¡ç†", 
                 link: "Javaè™šæ‹Ÿæœº.html"},
                {id: "Collection", name: "é›†åˆæ¡†æ¶", category: "æ ¸å¿ƒè¯­è¨€", level: 3,
                 description: "Listã€Setã€Mapç­‰æ•°æ®ç»“æ„", 
                 link: "é›†åˆæ¡†æ¶.html"},
                {id: "Thread", name: "å¤šçº¿ç¨‹", category: "æ ¸å¿ƒè¯­è¨€", level: 3,
                 description: "å¹¶å‘ç¼–ç¨‹ï¼ŒåŒæ­¥æœºåˆ¶ï¼Œçº¿ç¨‹æ± ", 
                 link: "å¤šçº¿ç¨‹.html"},
                {id: "Reflection", name: "åå°„æœºåˆ¶", category: "æ ¸å¿ƒè¯­è¨€", level: 4,
                 description: "è¿è¡Œæ—¶è·å–ç±»ä¿¡æ¯ï¼ŒåŠ¨æ€è°ƒç”¨", 
                 link: "åå°„æœºåˆ¶.html"},
                {id: "Annotation", name: "æ³¨è§£", category: "æ ¸å¿ƒè¯­è¨€", level: 4,
                 description: "å…ƒæ•°æ®æ ‡è®°ï¼Œä»£ç é…ç½®", 
                 link: "æ³¨è§£.html"},
                
                // Webå¼€å‘å±‚
                {id: "HTTP", name: "HTTPåè®®", category: "Webå¼€å‘", level: 1,
                 description: "è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œæ— çŠ¶æ€", 
                 link: "../Java-WebåŸºç¡€/index.html"},
                {id: "Servlet", name: "Servlet", category: "Webå¼€å‘", level: 2,
                 description: "Java Webåº”ç”¨æ ¸å¿ƒç»„ä»¶", 
                 link: "../Java-WebåŸºç¡€/index.html"},
                {id: "JSP", name: "JSP", category: "Webå¼€å‘", level: 3,
                 description: "JavaæœåŠ¡å™¨é¡µé¢æŠ€æœ¯", 
                 link: "../Java-WebåŸºç¡€/index.html"},
                {id: "Filter", name: "è¿‡æ»¤å™¨", category: "Webå¼€å‘", level: 3,
                 description: "è¯·æ±‚æ‹¦æˆªå¤„ç†", 
                 link: "../Java-WebåŸºç¡€/index.html"},
                {id: "Session", name: "ä¼šè¯ç®¡ç†", category: "Webå¼€å‘", level: 3,
                 description: "ç”¨æˆ·çŠ¶æ€ä¿æŒ", 
                 link: "../Java-WebåŸºç¡€/index.html"},
                {id: "AJAX", name: "AJAX", category: "Webå¼€å‘", level: 4,
                 description: "å¼‚æ­¥JavaScriptå’ŒXML", 
                 link: "../Java-WebåŸºç¡€/index.html"},
                {id: "JSON", name: "JSON", category: "Webå¼€å‘", level: 2,
                 description: "è½»é‡çº§æ•°æ®äº¤æ¢æ ¼å¼", 
                 link: "../Java-WebåŸºç¡€/index.html"},
                
                // æ•°æ®å¤„ç†å±‚
                {id: "JDBC", name: "JDBC", category: "æ•°æ®å¤„ç†", level: 2,
                 description: "Javaæ•°æ®åº“è¿æ¥API", 
                 link: "../JavaSEæ•™ç¨‹/index.html"},
                {id: "MySQL", name: "MySQL", category: "æ•°æ®å¤„ç†", level: 1,
                 description: "å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ", 
                 link: "../MySQLæ•™ç¨‹/index.html"},
                {id: "MyBatis", name: "MyBatis", category: "æ•°æ®å¤„ç†", level: 3,
                 description: "æŒä¹…å±‚æ¡†æ¶ï¼ŒSQLæ˜ å°„", 
                 link: "../MyBatisæ•™ç¨‹/index.html"},
                {id: "Transaction", name: "äº‹åŠ¡ç®¡ç†", category: "æ•°æ®å¤„ç†", level: 3,
                 description: "ACIDç‰¹æ€§ï¼Œæ•°æ®ä¸€è‡´æ€§", 
                 link: "../MyBatisæ•™ç¨‹/index.html"},
                {id: "ConnectionPool", name: "è¿æ¥æ± ", category: "æ•°æ®å¤„ç†", level: 4,
                 description: "æ•°æ®åº“è¿æ¥å¤ç”¨", 
                 link: "../MySQLæ•™ç¨‹/index.html"},
                
                // æ¡†æ¶æŠ€æœ¯å±‚
                {id: "Spring", name: "Springæ¡†æ¶", category: "æ¡†æ¶æŠ€æœ¯", level: 3,
                 description: "ä¼ä¸šçº§åº”ç”¨å¼€å‘æ¡†æ¶", 
                 link: "Springæ¡†æ¶.html"},
                {id: "IoC", name: "æ§åˆ¶åè½¬", category: "æ¡†æ¶æŠ€æœ¯", level: 4,
                 description: "å¯¹è±¡åˆ›å»ºå’Œä¾èµ–ç®¡ç†", 
                 link: "æ§åˆ¶åè½¬.html"},
                {id: "AOP", name: "é¢å‘åˆ‡é¢", category: "æ¡†æ¶æŠ€æœ¯", level: 4,
                 description: "æ¨ªåˆ‡å…³æ³¨ç‚¹åˆ†ç¦»", 
                 link: "é¢å‘åˆ‡é¢.html"},
                {id: "SpringMVC", name: "Spring MVC", category: "æ¡†æ¶æŠ€æœ¯", level: 4,
                 description: "MVC Webæ¡†æ¶", 
                 link: "../Springæ¡†æ¶æ•™ç¨‹/index.html"},
                {id: "SSM", name: "SSMæ¡†æ¶", category: "æ¡†æ¶æŠ€æœ¯", level: 4,
                 description: "Spring+SpringMVC+MyBatisæ•´åˆ", 
                 link: "../SSMæ¡†æ¶å¼€å‘/index.html"},
                {id: "SpringBoot", name: "Spring Boot", category: "æ¡†æ¶æŠ€æœ¯", level: 5,
                 description: "ç®€åŒ–Springé…ç½®", 
                 link: "../SpringBootæ•™ç¨‹/index.html"},
                {id: "AutoConfig", name: "è‡ªåŠ¨é…ç½®", category: "æ¡†æ¶æŠ€æœ¯", level: 5,
                 description: "çº¦å®šä¼˜äºé…ç½®", 
                 link: "../SpringBootæ•™ç¨‹/index.html"},
                {id: "Thymeleaf", name: "Thymeleaf", category: "Webå¼€å‘", level: 4,
                 description: "Javaæ¨¡æ¿å¼•æ“", 
                 link: "../SpringBootThymeleafæ•™ç¨‹/index.html"},
                {id: "Pay", name: "æ”¯ä»˜é›†æˆ", category: "Webå¼€å‘", level: 5,
                 description: "æ”¯ä»˜å®æ”¯ä»˜é›†æˆ", 
                 link: "../SpringBootæ”¯ä»˜å®æ•™ç¨‹/index.html"},
                {id: "UserActivation", name: "ç”¨æˆ·æ¿€æ´»", category: "Webå¼€å‘", level: 4,
                 description: "ç”¨æˆ·æ³¨å†Œæ¿€æ´»æµç¨‹", 
                 link: "../ç”¨æˆ·æ³¨å†Œæ¿€æ´»æ•™ç¨‹/index.html"},
                {id: "RESTful", name: "RESTful API", category: "Webå¼€å‘", level: 4,
                 description: "RESTæ¶æ„é£æ ¼APIè®¾è®¡", 
                 link: "../RESTfulæ•™ç¨‹/index.html"},
                {id: "Scrum", name: "æ•æ·å¼€å‘", category: "å·¥å…·éƒ¨ç½²", level: 2,
                 description: "Scrumæ•æ·å¼€å‘æ–¹æ³•", 
                 link: "../Scrumæ•æ·å¼€å‘æ•™ç¨‹/index.html"},
                {id: "Fiddler", name: "æŠ“åŒ…å·¥å…·", category: "å·¥å…·éƒ¨ç½²", level: 2,
                 description: "HTTPæŠ“åŒ…åˆ†æå·¥å…·", 
                 link: "../Fiddleræ•™ç¨‹/index.html"},
                
                // å¾®æœåŠ¡å±‚
                {id: "Microservices", name: "å¾®æœåŠ¡æ¶æ„", category: "å¾®æœåŠ¡", level: 5,
                 description: "åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„æ¨¡å¼", 
                 link: "å¾®æœåŠ¡æ¶æ„.html"},
                {id: "SpringCloud", name: "Spring Cloud", category: "å¾®æœåŠ¡", level: 6,
                 description: "å¾®æœåŠ¡å¼€å‘æ¡†æ¶", 
                 link: "../SpringCloudå¾®æœåŠ¡å¼€å‘/index.html"},
                {id: "Eureka", name: "æœåŠ¡æ³¨å†Œ", category: "å¾®æœåŠ¡", level: 6,
                 description: "æœåŠ¡æ³¨å†Œä¸å‘ç°", 
                 link: "æœåŠ¡æ³¨å†Œ.html"},
                {id: "Ribbon", name: "è´Ÿè½½å‡è¡¡", category: "å¾®æœåŠ¡", level: 6,
                 description: "å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡", 
                 link: "è´Ÿè½½å‡è¡¡.html"},
                {id: "Hystrix", name: "æ–­è·¯å™¨", category: "å¾®æœåŠ¡", level: 6,
                 description: "æœåŠ¡ç†”æ–­é™çº§", 
                 link: "æ–­è·¯å™¨.html"},
                {id: "Gateway", name: "ç½‘å…³", category: "å¾®æœåŠ¡", level: 6,
                 description: "APIç»Ÿä¸€å…¥å£", 
                 link: "ç½‘å…³.html"},
                {id: "Config", name: "é…ç½®ä¸­å¿ƒ", category: "å¾®æœåŠ¡", level: 6,
                 description: "é›†ä¸­é…ç½®ç®¡ç†", 
                 link: "é…ç½®ä¸­å¿ƒ.html"},
                {id: "DistributedTransaction", name: "åˆ†å¸ƒå¼äº‹åŠ¡", category: "å¾®æœåŠ¡", level: 6,
                 description: "è·¨æœåŠ¡æ•°æ®ä¸€è‡´æ€§æ–¹æ¡ˆï¼Œæ¶µç›–XA/2PCã€TCCã€Sagaä¸å¯é æ¶ˆæ¯", 
                 link: "åˆ†å¸ƒå¼äº‹åŠ¡.html"},
                
                // å·¥å…·éƒ¨ç½²å±‚
                {id: "Maven", name: "Maven", category: "å·¥å…·éƒ¨ç½²", level: 2,
                 description: "é¡¹ç›®ç®¡ç†æ„å»ºå·¥å…·", 
                 link: "../Mavenæ•™ç¨‹/index.html"},
                {id: "Git", name: "Git", category: "å·¥å…·éƒ¨ç½²", level: 2,
                 description: "åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶", 
                 link: "../Gitæ•™ç¨‹/index.html"},
                {id: "Docker", name: "Docker", category: "å·¥å…·éƒ¨ç½²", level: 5,
                 description: "å®¹å™¨åŒ–æŠ€æœ¯", 
                 link: "../Dockeræ•™ç¨‹/index.html"},
                {id: "Nginx", name: "Nginx", category: "å·¥å…·éƒ¨ç½²", level: 3,
                 description: "WebæœåŠ¡å™¨åå‘ä»£ç†", 
                 link: "../Nginxæ•™ç¨‹/index.html"},
                {id: "Redis", name: "Redis", category: "å·¥å…·éƒ¨ç½²", level: 4,
                 description: "å†…å­˜æ•°æ®åº“ç¼“å­˜", 
                 link: "../Redisç¼“å­˜ä¸æ•°æ®åº“æ•°æ®ä¸ä¸€è‡´/index.html"},
                
                // å®‰å…¨ä¸è®¤è¯å±‚
                {id: "Security", name: "Spring Security", category: "æ¡†æ¶æŠ€æœ¯", level: 4,
                 description: "Springå®‰å…¨æ¡†æ¶ï¼Œè®¤è¯ä¸æˆæƒ", 
                 link: "../SpringSecurityæ•™ç¨‹/index.html"},
                {id: "SSO", name: "å•ç‚¹ç™»å½•", category: "Webå¼€å‘", level: 5,
                 description: "Single Sign-Onå•ç‚¹ç™»å½•", 
                 link: "../å•ç‚¹ç™»å½•æ•™ç¨‹/index.html"},
                {id: "WebSecurity", name: "Webå®‰å…¨", category: "Webå¼€å‘", level: 4,
                 description: "Webåº”ç”¨å®‰å…¨é˜²æŠ¤", 
                 link: "../Webå®‰å…¨æ•™ç¨‹/index.html"},
                {id: "HTTPS", name: "HTTPS", category: "Webå¼€å‘", level: 3,
                 description: "å®‰å…¨è¶…æ–‡æœ¬ä¼ è¾“åè®®", 
                 link: "../HTTPSæ•™ç¨‹/index.html"},
                
                // æ¶ˆæ¯é˜Ÿåˆ—ä¸å¼‚æ­¥é€šä¿¡
                {id: "RabbitMQ", name: "RabbitMQ", category: "å¾®æœåŠ¡", level: 5,
                 description: "æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶", 
                 link: "../RabbitMQæ•™ç¨‹/index.html"},
                {id: "WebSocket", name: "WebSocket", category: "Webå¼€å‘", level: 4,
                 description: "å…¨åŒå·¥é€šä¿¡åè®®", 
                 link: "../WebSocketæ•™ç¨‹/index.html"},
                
                // ç¼“å­˜ä¸æ€§èƒ½ä¼˜åŒ–
                {id: "Cache", name: "ç¼“å­˜æŠ€æœ¯", category: "æ•°æ®å¤„ç†", level: 4,
                 description: "å¤šçº§ç¼“å­˜æ¶æ„", 
                 link: "../å¤šçº§ç¼“å­˜æ•™ç¨‹/index.html"},
                {id: "DistributedCache", name: "åˆ†å¸ƒå¼ç¼“å­˜", category: "å¾®æœåŠ¡", level: 5,
                 description: "åˆ†å¸ƒå¼ç¼“å­˜æ¶æ„", 
                 link: "../åˆ†å¸ƒå¼ç¼“å­˜/index.html"},
                {id: "DistributedLock", name: "åˆ†å¸ƒå¼é”", category: "å¾®æœåŠ¡", level: 5,
                 description: "åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„å¹¶å‘æ§åˆ¶", 
                 link: "../åˆ†å¸ƒå¼é”/index.html"},
                
                // é«˜å¹¶å‘åœºæ™¯
                {id: "Seckill", name: "ç§’æ€ç³»ç»Ÿ", category: "å¾®æœåŠ¡", level: 6,
                 description: "é«˜å¹¶å‘ç§’æ€ä¸šåŠ¡åœºæ™¯", 
                 link: "../ç§’æ€/index.html"},
                {id: "Ranking", name: "æ’è¡Œæ¦œ", category: "å¾®æœåŠ¡", level: 5,
                 description: "å®æ—¶æ’è¡Œæ¦œç³»ç»Ÿ", 
                 link: "../æ’è¡Œæ¦œ/index.html"},
                
                // æµ‹è¯•ä¸è´¨é‡ä¿è¯
                {id: "Testing", name: "è½¯ä»¶æµ‹è¯•", category: "å·¥å…·éƒ¨ç½²", level: 3,
                 description: "Java Webåº”ç”¨æµ‹è¯•", 
                 link: "../è½¯ä»¶æµ‹è¯•æ•™ç¨‹/index.html"},
                {id: "JavaWebTesting", name: "JavaWebæµ‹è¯•", category: "å·¥å…·éƒ¨ç½²", level: 4,
                 description: "Java Webåº”ç”¨ä¸“é¡¹æµ‹è¯•", 
                 link: "../JavaWebæµ‹è¯•æ•™ç¨‹/index.html"},
                {id: "SonarQube", name: "ä»£ç è´¨é‡", category: "å·¥å…·éƒ¨ç½²", level: 3,
                 description: "ä»£ç è´¨é‡æ£€æµ‹ä¸åˆ†æ", 
                 link: "../SonarQubeæ•™ç¨‹/index.html"},
                
                // Webå¼€å‘åŸºç¡€æŠ€æœ¯
                {id: "JavaWeb", name: "Java WebåŸºç¡€", category: "Webå¼€å‘", level: 2,
                 description: "Java Webå¼€å‘åŸºç¡€æŠ€æœ¯", 
                 link: "../Java-WebåŸºç¡€/index.html"},
                
                // Springæ¡†æ¶æ ¸å¿ƒ
                {id: "SpringCore", name: "Springæ¡†æ¶æ ¸å¿ƒ", category: "æ¡†æ¶æŠ€æœ¯", level: 3,
                 description: "Springæ¡†æ¶æ ¸å¿ƒæ¦‚å¿µå’Œæœºåˆ¶", 
                 link: "../Springæ¡†æ¶æ ¸å¿ƒ/index.html"},
                
                // ç¼“å­˜æŠ€æœ¯å®Œå–„
                {id: "SpringBootCache", name: "SpringBootç¼“å­˜", category: "æ¡†æ¶æŠ€æœ¯", level: 5,
                 description: "SpringBootç¼“å­˜é›†æˆ", 
                 link: "../SpringBootç¼“å­˜æ•™ç¨‹/index.html"},
                {id: "CacheBasic", name: "ç¼“å­˜åŸºç¡€", category: "æ•°æ®å¤„ç†", level: 3,
                 description: "ç¼“å­˜æŠ€æœ¯åŸºç¡€æ¦‚å¿µ", 
                 link: "../ç¼“å­˜æ•™ç¨‹/index.html"},
                
                // åˆ†å¸ƒå¼æ¶æ„
                {id: "DistributedArch", name: "åˆ†å¸ƒå¼æ¶æ„", category: "å¾®æœåŠ¡", level: 5,
                 description: "åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„è®¾è®¡", 
                 link: "../åˆ†å¸ƒå¼æ¶æ„/index.html"},
                
                // MySQLä¼˜åŒ–
                {id: "MySQLOptimization", name: "MySQLä¼˜åŒ–", category: "æ•°æ®å¤„ç†", level: 4,
                 description: "MySQLæ•°æ®åº“æ€§èƒ½ä¼˜åŒ–", 
                 link: "../MySQLä¼˜åŒ–/index.html"}
            ],
            
            // å®šä¹‰èŠ‚ç‚¹é—´çš„è¯­ä¹‰å…³ç³»
            links: [
                // Javaæ ¸å¿ƒä¾èµ–å…³ç³»
                {source: "Java", target: "OOP", relation: "åŸºäº", type: "implements"},
                {source: "Java", target: "JVM", relation: "è¿è¡Œäº", type: "runsOn"},
                {source: "OOP", target: "Collection", relation: "åŒ…å«", type: "contains"},
                {source: "Java", target: "Thread", relation: "æ”¯æŒ", type: "supports"},
                {source: "Java", target: "Reflection", relation: "æä¾›", type: "provides"},
                {source: "Java", target: "Annotation", relation: "æ”¯æŒ", type: "supports"},
                
                // Webå¼€å‘å…³ç³»
                {source: "Java", target: "Servlet", relation: "æ‰©å±•ä¸º", type: "extends"},
                {source: "HTTP", target: "Servlet", relation: "å®ç°", type: "implements"},
                {source: "Servlet", target: "JSP", relation: "é›†æˆ", type: "integrates"},
                {source: "Servlet", target: "Filter", relation: "ä½¿ç”¨", type: "uses"},
                {source: "HTTP", target: "Session", relation: "ç®¡ç†", type: "manages"},
                {source: "JSP", target: "AJAX", relation: "æ”¯æŒ", type: "supports"},
                {source: "AJAX", target: "JSON", relation: "ä¼ è¾“", type: "transfers"},
                
                // æ•°æ®å¤„ç†å…³ç³»
                {source: "Java", target: "JDBC", relation: "æä¾›", type: "provides"},
                {source: "JDBC", target: "MySQL", relation: "è¿æ¥", type: "connects"},
                {source: "JDBC", target: "MyBatis", relation: "å°è£…ä¸º", type: "wrappedBy"},
                {source: "JDBC", target: "Transaction", relation: "æ”¯æŒ", type: "supports"},
                {source: "JDBC", target: "ConnectionPool", relation: "ä¼˜åŒ–ä¸º", type: "optimizedBy"},
                
                // Springæ¡†æ¶å…³ç³»
                {source: "Reflection", target: "IoC", relation: "å®ç°åŸºç¡€", type: "enables"},
                {source: "Annotation", target: "IoC", relation: "é…ç½®æ–¹å¼", type: "configures"},
                {source: "IoC", target: "Spring", relation: "æ ¸å¿ƒç‰¹æ€§", type: "coreFeature"},
                {source: "AOP", target: "Spring", relation: "æ ¸å¿ƒç‰¹æ€§", type: "coreFeature"},
                {source: "Spring", target: "SpringMVC", relation: "åŒ…å«", type: "contains"},
                {source: "Servlet", target: "SpringMVC", relation: "åŸºäº", type: "basedOn"},
                {source: "Spring", target: "SpringBoot", relation: "ç®€åŒ–ä¸º", type: "simplifiedBy"},
                {source: "Annotation", target: "AutoConfig", relation: "é©±åŠ¨", type: "drives"},
                {source: "MyBatis", target: "Spring", relation: "é›†æˆ", type: "integrates"},
                {source: "Spring", target: "SSM", relation: "ç»„æˆ", type: "composes"},
                {source: "SpringMVC", target: "SSM", relation: "ç»„æˆ", type: "composes"},
                {source: "MyBatis", target: "SSM", relation: "ç»„æˆ", type: "composes"},
                
                // å¾®æœåŠ¡å…³ç³»
                {source: "SpringBoot", target: "Microservices", relation: "æ”¯æŒ", type: "supports"},
                {source: "Microservices", target: "SpringCloud", relation: "å®ç°æ¡†æ¶", type: "implementedBy"},
                {source: "SpringCloud", target: "Eureka", relation: "åŒ…å«", type: "contains"},
                {source: "SpringCloud", target: "Ribbon", relation: "åŒ…å«", type: "contains"},
                {source: "SpringCloud", target: "Hystrix", relation: "åŒ…å«", type: "contains"},
                {source: "SpringCloud", target: "Gateway", relation: "åŒ…å«", type: "contains"},
                {source: "SpringCloud", target: "Config", relation: "åŒ…å«", type: "contains"},
                {source: "Microservices", target: "DistributedTransaction", relation: "ä¿éšœä¸€è‡´æ€§", type: "requires"},
                {source: "DistributedTransaction", target: "Transaction", relation: "æ‰©å±•", type: "extends"},
                {source: "DistributedTransaction", target: "RabbitMQ", relation: "ç»“åˆå¼‚æ­¥", type: "uses"},
                {source: "DistributedTransaction", target: "MySQL", relation: "è½åœ°æ•°æ®åº“", type: "uses"},
                {source: "Eureka", target: "Ribbon", relation: "é…åˆ", type: "collaborates"},
                {source: "Ribbon", target: "Hystrix", relation: "ä¿æŠ¤", type: "protects"},
                
                // å·¥å…·é›†æˆå…³ç³»
                {source: "Maven", target: "SpringBoot", relation: "æ„å»º", type: "builds"},
                {source: "Git", target: "Maven", relation: "ç®¡ç†", type: "manages"},
                {source: "Docker", target: "Microservices", relation: "éƒ¨ç½²", type: "deploys"},
                {source: "Nginx", target: "SpringBoot", relation: "ä»£ç†", type: "proxies"},
                {source: "Redis", target: "Session", relation: "å­˜å‚¨", type: "stores"},
                {source: "Redis", target: "SpringBoot", relation: "ç¼“å­˜", type: "caches"},
                
                // å®‰å…¨ä¸è®¤è¯å…³ç³»
                {source: "Spring", target: "Security", relation: "é›†æˆ", type: "integrates"},
                {source: "Security", target: "SSO", relation: "å®ç°", type: "implements"},
                {source: "HTTPS", target: "WebSecurity", relation: "ä¿éšœ", type: "secures"},
                {source: "HTTP", target: "HTTPS", relation: "å‡çº§ä¸º", type: "upgrades"},
                
                // æ¶ˆæ¯é˜Ÿåˆ—å…³ç³»
                {source: "SpringBoot", target: "RabbitMQ", relation: "é›†æˆ", type: "integrates"},
                {source: "Microservices", target: "RabbitMQ", relation: "ä½¿ç”¨", type: "uses"},
                {source: "HTTP", target: "WebSocket", relation: "å‡çº§ä¸º", type: "upgrades"},
                
                // ç¼“å­˜ä¸æ€§èƒ½å…³ç³»
                {source: "Redis", target: "Cache", relation: "å®ç°", type: "implements"},
                {source: "Cache", target: "DistributedCache", relation: "æ‰©å±•ä¸º", type: "extends"},
                {source: "Redis", target: "DistributedLock", relation: "å®ç°", type: "implements"},
                {source: "DistributedCache", target: "Seckill", relation: "æ”¯æŒ", type: "supports"},
                {source: "DistributedLock", target: "Seckill", relation: "ä¿æŠ¤", type: "protects"},
                {source: "Redis", target: "Ranking", relation: "å®ç°", type: "implements"},
                
                // æµ‹è¯•è´¨é‡å…³ç³»
                {source: "SpringBoot", target: "Testing", relation: "æ”¯æŒ", type: "supports"},
                {source: "Maven", target: "SonarQube", relation: "é›†æˆ", type: "integrates"},
                
                // Spring Bootç”Ÿæ€å…³ç³»
                {source: "SpringBoot", target: "Thymeleaf", relation: "é›†æˆ", type: "integrates"},
                {source: "SpringBoot", target: "Pay", relation: "æ”¯æŒ", type: "supports"},
                {source: "SpringMVC", target: "RESTful", relation: "å®ç°", type: "implements"},
                {source: "Session", target: "UserActivation", relation: "ç®¡ç†", type: "manages"},
                
                // å¼€å‘å·¥å…·å…³ç³»
                {source: "HTTP", target: "Fiddler", relation: "è°ƒè¯•å·¥å…·", type: "debuggedBy"},
                {source: "Git", target: "Scrum", relation: "é…åˆ", type: "collaborates"},
                
                // æ–°å¢èŠ‚ç‚¹å…³ç³»
                {source: "Java", target: "JavaWeb", relation: "æ‰©å±•ä¸º", type: "extends"},
                {source: "JavaWeb", target: "HTTP", relation: "åŸºäº", type: "basedOn"},
                {source: "JavaWeb", target: "Servlet", relation: "åŒ…å«", type: "contains"},
                {source: "Spring", target: "SpringCore", relation: "æ ¸å¿ƒ", type: "coreFeature"},
                {source: "SpringBoot", target: "SpringBootCache", relation: "é›†æˆ", type: "integrates"},
                {source: "CacheBasic", target: "Cache", relation: "æ‰©å±•ä¸º", type: "extends"},
                {source: "MySQL", target: "MySQLOptimization", relation: "ä¼˜åŒ–", type: "optimizes"},
                {source: "Microservices", target: "DistributedArch", relation: "å®ç°", type: "implements"},
                {source: "Testing", target: "JavaWebTesting", relation: "ä¸“é¡¹", type: "specializes"}
            ]
        };
        
        // é¢œè‰²æ˜ å°„
        const colorMap = {
            "æ ¸å¿ƒè¯­è¨€": "#ff6b6b",
            "Webå¼€å‘": "#4ecdc4", 
            "æ•°æ®å¤„ç†": "#45b7d1",
            "æ¡†æ¶æŠ€æœ¯": "#96ceb4",
            "å¾®æœåŠ¡": "#feca57",
            "å·¥å…·éƒ¨ç½²": "#ff9ff3"
        };
        
        // å…³ç³»ç±»å‹é¢œè‰²
        const relationColors = {
            "implements": "#e74c3c",
            "extends": "#f39c12", 
            "contains": "#2ecc71",
            "uses": "#3498db",
            "supports": "#9b59b6"
        };
        
        // åˆ›å»ºSVGç”»å¸ƒ
        const width = window.innerWidth;
        const height = window.innerHeight - 80;
        
        const svg = document.createElement('div');
        svg.innerHTML = `
            <svg width="${width}" height="${height}" style="background: transparent;">
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                     refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#999" />
                    </marker>
                </defs>
                <g class="zoom-container"></g>
            </svg>
        `;
        document.getElementById('knowledge-graph').appendChild(svg.firstElementChild);
        
        // ç¼©æ”¾å’Œå¹³ç§»çŠ¶æ€
        let currentScale = 1;
        let currentTranslateX = 0;
        let currentTranslateY = 0;
        let isDragging = false;
        let dragStart = {x: 0, y: 0};
        
        const svgElement = document.querySelector('#knowledge-graph svg');
        const zoomContainer = document.querySelector('.zoom-container');
        
        // ä½¿ç”¨åŸç”ŸJavaScriptå®ç°ç®€åŒ–ç‰ˆåŠ›å¯¼å‘å›¾
        let nodes = [...knowledgeData.nodes];
        let links = [...knowledgeData.links];
        
        // å›ºå®šèŠ‚ç‚¹ä½ç½® - æ ¹æ®ç±»åˆ«å’Œå±‚çº§è®¡ç®—
        function initializeFixedPositions() {
            const categories = ["æ ¸å¿ƒè¯­è¨€", "Webå¼€å‘", "æ•°æ®å¤„ç†", "æ¡†æ¶æŠ€æœ¯", "å¾®æœåŠ¡", "å·¥å…·éƒ¨ç½²"];
            const categoryPositions = {
                "æ ¸å¿ƒè¯­è¨€": {centerX: width * 0.2, centerY: height * 0.3, radius: 120},
                "Webå¼€å‘": {centerX: width * 0.5, centerY: height * 0.2, radius: 140},
                "æ•°æ®å¤„ç†": {centerX: width * 0.8, centerY: height * 0.3, radius: 100},
                "æ¡†æ¶æŠ€æœ¯": {centerX: width * 0.3, centerY: height * 0.6, radius: 150},
                "å¾®æœåŠ¡": {centerX: width * 0.7, centerY: height * 0.7, radius: 160},
                "å·¥å…·éƒ¨ç½²": {centerX: width * 0.5, centerY: height * 0.8, radius: 120}
            };
            
            // æŒ‰ç±»åˆ«åˆ†ç»„èŠ‚ç‚¹
            const nodesByCategory = {};
            categories.forEach(cat => nodesByCategory[cat] = []);
            
            nodes.forEach(node => {
                if (nodesByCategory[node.category]) {
                    nodesByCategory[node.category].push(node);
                }
            });
            
            // ä¸ºæ¯ä¸ªç±»åˆ«çš„èŠ‚ç‚¹åˆ†é…å›ºå®šä½ç½®
            Object.keys(nodesByCategory).forEach(category => {
                const categoryNodes = nodesByCategory[category];
                const pos = categoryPositions[category];
                
                if (pos && categoryNodes.length > 0) {
                    categoryNodes.forEach((node, index) => {
                        // æ ¹æ®èŠ‚ç‚¹åœ¨ç±»åˆ«ä¸­çš„ç´¢å¼•å’Œå±‚çº§è®¡ç®—è§’åº¦
                        const angle = (index / categoryNodes.length) * 2 * Math.PI;
                        const levelRadius = pos.radius * (0.3 + node.level * 0.15);
                        
                        // ä½¿ç”¨èŠ‚ç‚¹IDçš„å“ˆå¸Œå€¼ä½œä¸ºç§å­ï¼Œç¡®ä¿ä½ç½®å›ºå®š
                        const hash = node.id.split('').reduce((a, b) => {
                            a = ((a << 5) - a) + b.charCodeAt(0);
                            return a & a;
                        }, 0);
                        const randomOffset = (Math.abs(hash) % 100) / 100;
                        
                        node.x = pos.centerX + Math.cos(angle + randomOffset) * levelRadius;
                        node.y = pos.centerY + Math.sin(angle + randomOffset) * levelRadius;
                        
                        // ç¡®ä¿èŠ‚ç‚¹åœ¨ç”»å¸ƒèŒƒå›´å†…
                        node.x = Math.max(30, Math.min(width - 30, node.x));
                        node.y = Math.max(30, Math.min(height - 30, node.y));
                        
                        node.vx = 0;
                        node.vy = 0;
                    });
                }
            });
        }
        
        initializeFixedPositions();
        
        // åˆ›å»ºèŠ‚ç‚¹å’Œè¿çº¿çš„SVGå…ƒç´ 
        // svgElement å·²åœ¨ä¸Šé¢å®šä¹‰
        
        // æ·»åŠ ç¼©æ”¾å’Œæ‹–æ‹½äº‹ä»¶
        function initializeZoomAndPan() {
            // é¼ æ ‡æ»šè½®ç¼©æ”¾
            svgElement.addEventListener('wheel', (e) => {
                e.preventDefault();
                const rect = svgElement.getBoundingClientRect();
                const mouseX = e.clientX - rect.left;
                const mouseY = e.clientY - rect.top;
                
                const scaleFactor = e.deltaY > 0 ? 0.9 : 1.1;
                const newScale = Math.max(0.3, Math.min(3, currentScale * scaleFactor));
                
                if (newScale !== currentScale) {
                    const scaleChange = newScale / currentScale;
                    currentTranslateX = mouseX - (mouseX - currentTranslateX) * scaleChange;
                    currentTranslateY = mouseY - (mouseY - currentTranslateY) * scaleChange;
                    currentScale = newScale;
                    updateTransform();
                }
            });
            
            // é¼ æ ‡æ‹–æ‹½å¹³ç§»
            svgElement.addEventListener('mousedown', (e) => {
                if (e.target === svgElement || e.target.classList.contains('zoom-container')) {
                    isDragging = true;
                    dragStart.x = e.clientX - currentTranslateX;
                    dragStart.y = e.clientY - currentTranslateY;
                    svgElement.style.cursor = 'grabbing';
                }
            });
            
            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    currentTranslateX = e.clientX - dragStart.x;
                    currentTranslateY = e.clientY - dragStart.y;
                    updateTransform();
                }
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
                svgElement.style.cursor = 'default';
            });
        }
        
        function updateTransform() {
            zoomContainer.setAttribute('transform', 
                `translate(${currentTranslateX}, ${currentTranslateY}) scale(${currentScale})`);
            updateStatusBar();
        }
        
        function updateStatusBar() {
            const visibleNodes = nodes.filter(node => 
                node.element.style.display !== 'none').length;
            const visibleLinks = links.filter(link => 
                link.element.style.display !== 'none').length;
            
            document.getElementById('node-count').textContent = `èŠ‚ç‚¹: ${visibleNodes}/${nodes.length}`;
            document.getElementById('link-count').textContent = `è¿æ¥: ${visibleLinks}/${links.length}`;
            document.getElementById('zoom-level').textContent = `ç¼©æ”¾: ${Math.round(currentScale * 100)}%`;
        }

        function initializeGraph() {
            // æ¸…ç©ºç°æœ‰å…ƒç´ 
            zoomContainer.querySelectorAll('.link, .node, .label').forEach(el => el.remove());
            
            // åˆ›å»ºè¿çº¿
            links.forEach(link => {
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('class', 'link');
                line.setAttribute('stroke', relationColors[link.type] || '#999');
                line.setAttribute('stroke-width', '2');
                line.setAttribute('opacity', '0.6');
                line.setAttribute('marker-end', 'url(#arrowhead)');
                zoomContainer.appendChild(line);
                link.element = line;
            });
            
            // åˆ›å»ºèŠ‚ç‚¹
            nodes.forEach(node => {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('class', 'node');
                circle.setAttribute('r', 8 + node.level * 2);
                circle.setAttribute('fill', colorMap[node.category]);
                circle.setAttribute('stroke', '#fff');
                circle.setAttribute('stroke-width', '2');
                circle.style.cursor = 'pointer';
                
                // æ·»åŠ äº‹ä»¶ç›‘å¬
                circle.addEventListener('mouseenter', (e) => showTooltip(e, node));
                circle.addEventListener('mouseleave', hideTooltip);
                
                // ä½¿ç”¨æ–°çš„åŒå‡»å¤„ç†å‡½æ•°
                addDoubleClickHandler(circle, node);
                
                // æ·»åŠ å³é”®èœå•
                addContextMenu(circle, node);
                
                zoomContainer.appendChild(circle);
                node.element = circle;
                
                // åˆ›å»ºæ ‡ç­¾
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('class', 'label');
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('dy', '0.35em');
                text.setAttribute('font-size', '10px');
                text.setAttribute('fill', 'white');
                text.setAttribute('font-weight', 'bold');
                text.style.pointerEvents = 'none';
                text.textContent = node.name;
                zoomContainer.appendChild(text);
                node.labelElement = text;
            });
            
            // å¼€å§‹åŠ›å¯¼å‘å¸ƒå±€åŠ¨ç”»
            startSimulation();
        }
        
        function startSimulation() {
            let alpha = 0.3; // é™ä½åˆå§‹å¼ºåº¦ï¼Œå› ä¸ºå·²æœ‰å›ºå®šå¸ƒå±€
            const alphaDecay = 0.05; // åŠ å¿«æ”¶æ•›é€Ÿåº¦
            
            function tick() {
                // åŠ›è®¡ç®—
                applyForces();
                
                // æ›´æ–°ä½ç½®
                updatePositions();
                
                alpha *= (1 - alphaDecay);
                if (alpha > 0.005) { // æ›´æ—©åœæ­¢åŠ¨ç”»
                    requestAnimationFrame(tick);
                }
            }
            
            tick();
        }
        
        function applyForces() {
            // è½»å¾®çš„ä¸­å¿ƒå¼•åŠ›ï¼Œä¿æŒæ•´ä½“å¸ƒå±€
            const centerX = width / 2;
            const centerY = height / 2;
            
            nodes.forEach(node => {
                node.vx += (centerX - node.x) * 0.00005; // å‡å¼±ä¸­å¿ƒå¼•åŠ›
                node.vy += (centerY - node.y) * 0.00005;
            });
            
            // èŠ‚ç‚¹é—´æ’æ–¥åŠ› - é˜²æ­¢é‡å 
            for (let i = 0; i < nodes.length; i++) {
                for (let j = i + 1; j < nodes.length; j++) {
                    const a = nodes[i];
                    const b = nodes[j];
                    const dx = b.x - a.x;
                    const dy = b.y - a.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < 80) { // å‡å°æ’æ–¥èŒƒå›´
                        const force = 200 / (distance * distance); // å‡å¼±æ’æ–¥åŠ›
                        const fx = (dx / distance) * force;
                        const fy = (dy / distance) * force;
                        
                        a.vx -= fx;
                        a.vy -= fy;
                        b.vx += fx;
                        b.vy += fy;
                    }
                }
            }
            
            // è¿çº¿å¼•åŠ› - ä¿æŒè¿æ¥å…³ç³»
            links.forEach(link => {
                const source = nodes.find(n => n.id === link.source);
                const target = nodes.find(n => n.id === link.target);
                
                if (source && target) {
                    const dx = target.x - source.x;
                    const dy = target.y - source.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    const force = distance * 0.0005; // å‡å¼±è¿çº¿å¼•åŠ›
                    
                    const fx = (dx / distance) * force;
                    const fy = (dy / distance) * force;
                    
                    source.vx += fx;
                    source.vy += fy;
                    target.vx -= fx;
                    target.vy -= fy;
                }
            });
        }
        
        function updatePositions() {
            nodes.forEach(node => {
                node.vx *= 0.9; // é˜»å°¼
                node.vy *= 0.9;
                
                node.x += node.vx;
                node.y += node.vy;
                
                // è¾¹ç•Œæ£€æŸ¥
                node.x = Math.max(20, Math.min(width - 20, node.x));
                node.y = Math.max(20, Math.min(height - 20, node.y));
                
                // æ›´æ–°SVGå…ƒç´ ä½ç½®
                if (node.element) {
                    node.element.setAttribute('cx', node.x);
                    node.element.setAttribute('cy', node.y);
                }
                if (node.labelElement) {
                    node.labelElement.setAttribute('x', node.x);
                    node.labelElement.setAttribute('y', node.y);
                }
            });
            
            // æ›´æ–°è¿çº¿
            links.forEach(link => {
                const source = nodes.find(n => n.id === link.source);
                const target = nodes.find(n => n.id === link.target);
                
                if (source && target && link.element) {
                    link.element.setAttribute('x1', source.x);
                    link.element.setAttribute('y1', source.y);
                    link.element.setAttribute('x2', target.x);
                    link.element.setAttribute('y2', target.y);
                }
            });
        }
        
        function showTooltip(event, node) {
            const tooltip = document.getElementById('tooltip');
            tooltip.style.display = 'block';
            tooltip.style.left = (event.pageX + 10) + 'px';
            tooltip.style.top = (event.pageY - 10) + 'px';
            tooltip.innerHTML = `
                <strong>${node.name}</strong><br>
                åˆ†ç±»: ${node.category}<br>
                å±‚çº§: ${node.level}<br>
                ${node.description}
            `;
        }
        
        function hideTooltip() {
            document.getElementById('tooltip').style.display = 'none';
        }
        
        function showNodeInfo(node) {
            const panel = document.getElementById('info-panel');
            document.getElementById('node-title').textContent = node.name;
            document.getElementById('node-description').textContent = node.description;
            
            // æ˜¾ç¤ºç›¸å…³è¿æ¥
            const relations = links.filter(link => 
                link.source === node.id || link.target === node.id
            );
            
            const relationsHtml = relations.map(link => {
                const isSource = link.source === node.id;
                const otherNode = isSource ? link.target : link.source;
                const direction = isSource ? 'â†’' : 'â†';
                return `<div>${direction} ${link.relation} ${otherNode}</div>`;
            }).join('');
            
            document.getElementById('node-relations').innerHTML = 
                `<h5>å…³ç³»è¿æ¥:</h5>${relationsHtml}`;
            
            panel.style.display = 'block';
            
            // 5ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                panel.style.display = 'none';
            }, 5000);
        }
        
        function filterByCategory(category) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.control-btn').forEach(btn => 
                btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // è¿‡æ»¤æ˜¾ç¤º
            nodes.forEach(node => {
                const show = node.category === category;
                node.element.style.display = show ? 'block' : 'none';
                node.labelElement.style.display = show ? 'block' : 'none';
            });
            
            links.forEach(link => {
                const sourceNode = nodes.find(n => n.id === link.source);
                const targetNode = nodes.find(n => n.id === link.target);
                const show = sourceNode.category === category && 
                           targetNode.category === category;
                link.element.style.display = show ? 'block' : 'none';
            });
            
            updateStatusBar();
        }
        
        function showAllNodes() {
            document.querySelectorAll('.control-btn').forEach(btn => 
                btn.classList.remove('active'));
            event.target.classList.add('active');
            
            nodes.forEach(node => {
                node.element.style.display = 'block';
                node.labelElement.style.display = 'block';
            });
            
            links.forEach(link => {
                link.element.style.display = 'block';
            });
            
            updateStatusBar();
        }
        
        function resetGraph() {
            // é‡ç½®åˆ°å›ºå®šçš„åˆå§‹ä½ç½®
            initializeFixedPositions();
            
            // é‡ç½®ç¼©æ”¾å’Œå¹³ç§»
            currentScale = 1;
            currentTranslateX = 0;
            currentTranslateY = 0;
            updateTransform();
            
            // é‡æ–°å¼€å§‹å¸ƒå±€åŠ¨ç”»
            startSimulation();
        }
        
        // æœç´¢åŠŸèƒ½
        function searchNodes(query) {
            const searchTerm = query.toLowerCase().trim();
            
            if (!searchTerm) {
                showAllNodes();
                return;
            }
            
            let foundNodes = [];
            
            nodes.forEach(node => {
                const matches = node.name.toLowerCase().includes(searchTerm) ||
                               node.description.toLowerCase().includes(searchTerm) ||
                               node.category.toLowerCase().includes(searchTerm);
                
                if (matches) {
                    foundNodes.push(node);
                    node.element.style.display = 'block';
                    node.labelElement.style.display = 'block';
                    // é«˜äº®åŒ¹é…çš„èŠ‚ç‚¹
                    node.element.style.stroke = '#feca57';
                    node.element.style.strokeWidth = '3px';
                } else {
                    node.element.style.display = 'none';
                    node.labelElement.style.display = 'none';
                    node.element.style.stroke = 'none';
                    node.element.style.strokeWidth = '0px';
                }
            });
            
            // æ˜¾ç¤ºç›¸å…³è¿æ¥
            links.forEach(link => {
                const sourceVisible = foundNodes.some(n => n.id === link.source);
                const targetVisible = foundNodes.some(n => n.id === link.target);
                link.element.style.display = (sourceVisible && targetVisible) ? 'block' : 'none';
            });
            
            // å¦‚æœåªæ‰¾åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè‡ªåŠ¨å±…ä¸­æ˜¾ç¤º
            if (foundNodes.length === 1) {
                centerOnNode(foundNodes[0]);
            }
            
            updateStatusBar();
        }
        
        // å±…ä¸­æ˜¾ç¤ºèŠ‚ç‚¹
        function centerOnNode(node) {
            const centerX = width / 2;
            const centerY = height / 2;
            
            currentTranslateX = centerX - node.x * currentScale;
            currentTranslateY = centerY - node.y * currentScale;
            updateTransform();
        }
        
        // æ·»åŠ é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            // Ctrl + F èšç„¦æœç´¢æ¡†
            if (e.ctrlKey && e.key === 'f') {
                e.preventDefault();
                document.getElementById('searchInput').focus();
            }
            
            // ESC æ¸…ç©ºæœç´¢æˆ–å…³é—­å¸®åŠ©
            if (e.key === 'Escape') {
                const helpPanel = document.getElementById('help-panel');
                if (helpPanel.style.display === 'block') {
                    toggleHelp();
                } else {
                    document.getElementById('searchInput').value = '';
                    showAllNodes();
                }
            }
            
            // F1 æ˜¾ç¤ºå¸®åŠ©
            if (e.key === 'F1') {
                e.preventDefault();
                toggleHelp();
            }
            
            // æ–¹å‘é”®ç§»åŠ¨è§†å›¾
            const moveDistance = 50;
            switch(e.key) {
                case 'ArrowUp':
                    currentTranslateY += moveDistance;
                    updateTransform();
                    break;
                case 'ArrowDown':
                    currentTranslateY -= moveDistance;
                    updateTransform();
                    break;
                case 'ArrowLeft':
                    currentTranslateX += moveDistance;
                    updateTransform();
                    break;
                case 'ArrowRight':
                    currentTranslateX -= moveDistance;
                    updateTransform();
                    break;
            }
        });
        
        // æœç´¢æ¡†æ ·å¼ä¼˜åŒ–
        const searchInput = document.getElementById('searchInput');
        searchInput.addEventListener('focus', () => {
            searchInput.style.background = 'rgba(255,255,255,0.2)';
            searchInput.style.borderColor = '#feca57';
        });
        
        searchInput.addEventListener('blur', () => {
            searchInput.style.background = 'rgba(255,255,255,0.1)';
            searchInput.style.borderColor = 'rgba(255,255,255,0.3)';
        });
        
        // æ·»åŠ èŠ‚ç‚¹åŒå‡»åŠŸèƒ½ - å¿«é€Ÿè·³è½¬åˆ°å­¦ä¹ é¡µé¢
        function addDoubleClickHandler(circle, node) {
            let clickCount = 0;
            circle.addEventListener('click', (e) => {
                clickCount++;
                setTimeout(() => {
                    if (clickCount === 1) {
                        // å•å‡» - æ˜¾ç¤ºä¿¡æ¯
                        showNodeInfo(node);
                    } else if (clickCount === 2) {
                        // åŒå‡» - è·³è½¬åˆ°å­¦ä¹ é¡µé¢
                        if (node.link) {
                            window.open(node.link, '_blank');
                        }
                    }
                    clickCount = 0;
                }, 300);
            });
        }
        
        // æ·»åŠ å³é”®èœå•åŠŸèƒ½
        function addContextMenu(element, node) {
            element.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                showContextMenu(e, node);
            });
        }
        
        function showContextMenu(event, node) {
            // åˆ›å»ºå³é”®èœå•
            const existingMenu = document.getElementById('contextMenu');
            if (existingMenu) {
                existingMenu.remove();
            }
            
            const menu = document.createElement('div');
            menu.id = 'contextMenu';
            menu.style.cssText = `
                position: fixed;
                left: ${event.clientX}px;
                top: ${event.clientY}px;
                background: rgba(0,0,0,0.9);
                border: 1px solid rgba(255,255,255,0.2);
                border-radius: 8px;
                padding: 8px 0;
                z-index: 2000;
                min-width: 150px;
                backdrop-filter: blur(10px);
            `;
            
            const menuItems = [
                { text: 'ğŸ“– æŸ¥çœ‹è¯¦æƒ…', action: () => showNodeInfo(node) },
                { text: 'ğŸ”— æ‰“å¼€å­¦ä¹ é¡µé¢', action: () => window.open(node.link, '_blank') },
                { text: 'ğŸ¯ å±…ä¸­æ˜¾ç¤º', action: () => centerOnNode(node) },
                { text: 'ğŸ” æŸ¥æ‰¾ç›¸å…³', action: () => findRelatedNodes(node) }
            ];
            
            menuItems.forEach(item => {
                const menuItem = document.createElement('div');
                menuItem.textContent = item.text;
                menuItem.style.cssText = `
                    padding: 8px 16px;
                    cursor: pointer;
                    font-size: 13px;
                    color: white;
                    transition: background 0.2s;
                `;
                
                menuItem.addEventListener('mouseenter', () => {
                    menuItem.style.background = 'rgba(255,255,255,0.1)';
                });
                
                menuItem.addEventListener('mouseleave', () => {
                    menuItem.style.background = 'transparent';
                });
                
                menuItem.addEventListener('click', () => {
                    item.action();
                    menu.remove();
                });
                
                menu.appendChild(menuItem);
            });
            
            document.body.appendChild(menu);
            
            // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå•
            setTimeout(() => {
                document.addEventListener('click', () => {
                    if (menu.parentNode) {
                        menu.remove();
                    }
                }, { once: true });
            }, 100);
        }
        
        // æŸ¥æ‰¾ç›¸å…³èŠ‚ç‚¹
        function findRelatedNodes(node) {
            const relatedIds = new Set();
            relatedIds.add(node.id);
            
            // æ‰¾åˆ°æ‰€æœ‰ç›´æ¥è¿æ¥çš„èŠ‚ç‚¹
            links.forEach(link => {
                if (link.source === node.id) {
                    relatedIds.add(link.target);
                } else if (link.target === node.id) {
                    relatedIds.add(link.source);
                }
            });
            
            // æ˜¾ç¤ºç›¸å…³èŠ‚ç‚¹
            nodes.forEach(n => {
                if (relatedIds.has(n.id)) {
                    n.element.style.display = 'block';
                    n.labelElement.style.display = 'block';
                    n.element.style.stroke = '#ff9ff3';
                    n.element.style.strokeWidth = '2px';
                } else {
                    n.element.style.display = 'none';
                    n.labelElement.style.display = 'none';
                }
            });
            
            // æ˜¾ç¤ºç›¸å…³è¿æ¥
            links.forEach(link => {
                const show = relatedIds.has(link.source) && relatedIds.has(link.target);
                link.element.style.display = show ? 'block' : 'none';
            });
        }
        
        // å¸®åŠ©é¢æ¿åˆ‡æ¢
        function toggleHelp() {
            const helpPanel = document.getElementById('help-panel');
            if (helpPanel.style.display === 'block') {
                helpPanel.style.display = 'none';
            } else {
                helpPanel.style.display = 'block';
            }
        }
        
        // å›¾ä¾‹æŠ˜å åˆ‡æ¢
        function toggleLegend() {
            const legend = document.getElementById('legend');
            const toggle = document.getElementById('legend-toggle');
            
            if (legend.classList.contains('collapsed')) {
                legend.classList.remove('collapsed');
                toggle.textContent = 'â–¼';
            } else {
                legend.classList.add('collapsed');
                toggle.textContent = 'â–¶';
            }
        }
        
        // ç®€åŒ–æ¨¡å¼åˆ‡æ¢
        let isSimpleMode = false;
        function toggleSimpleMode() {
            isSimpleMode = !isSimpleMode;
            const btn = document.getElementById('simple-mode-btn');
            
            if (isSimpleMode) {
                btn.textContent = 'ğŸ¨ å®Œæ•´æ¨¡å¼';
                btn.classList.add('active');
                
                // éšè—è¿çº¿ï¼Œåªæ˜¾ç¤ºæ ¸å¿ƒèŠ‚ç‚¹
                links.forEach(link => {
                    link.element.style.display = 'none';
                });
                
                // åªæ˜¾ç¤ºlevel 1-2çš„é‡è¦èŠ‚ç‚¹
                nodes.forEach(node => {
                    if (node.level <= 2) {
                        node.element.style.display = 'block';
                        node.labelElement.style.display = 'block';
                        // å¢å¤§æ ¸å¿ƒèŠ‚ç‚¹
                        node.element.setAttribute('r', 12 + node.level * 3);
                    } else {
                        node.element.style.display = 'none';
                        node.labelElement.style.display = 'none';
                    }
                });
                
            } else {
                btn.textContent = 'âš¡ ç®€åŒ–æ¨¡å¼';
                btn.classList.remove('active');
                
                // æ¢å¤æ‰€æœ‰å…ƒç´ 
                showAllNodes();
                
                // æ¢å¤èŠ‚ç‚¹å¤§å°
                nodes.forEach(node => {
                    node.element.setAttribute('r', 8 + node.level * 2);
                });
            }
            
            updateStatusBar();
        }
        
        // åˆå§‹åŒ–å›¾è°±
        initializeGraph();
        initializeZoomAndPan();
        updateStatusBar();
        
        // å“åº”å¼å¤„ç†
        window.addEventListener('resize', () => {
            location.reload();
        });
    </script>
</body>
</html> 
